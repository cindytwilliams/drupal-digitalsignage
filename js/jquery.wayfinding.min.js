!function(t){"use strict";var e,o={maps:[{path:"floorplan.svg",id:"map.1"}],path:{color:"red",radius:10,speed:8,width:3},startpoint:function(){return"startpoint"},endpoint:!1,accessibleRoute:!1,defaultMap:function(){return"map.1"},loadMessage:"Loading",dataStoreCache:null,showLocation:!1,locationIndicator:{fill:"red",height:40},pinchToZoom:!1,zoomToRoute:!0,zoomPadding:25,floorChangeAnimationDelay:1250};t.fn.wayfinding=function(n,i,a){function r(t){return t.replace(/(:|\.|\[|\])/g,"\\$1")}function s(t,e,o,n){return(n-o)/n*t+o/n*e}function p(t){this.value=t,this.message=" no maps identified in collection to load",this.toString=function(){return this.value+this.message}}function l(t){this.value=t,this.message=" has duplicate map ids",this.toString=function(){return this.value+this.message}}function h(t){this.value=t,this.message=" wasn't in the list of maps",this.toString=function(){return this.value+this.message}}function f(e){var o,n,a,r=!1,s=!1;if(a=t(e).find("div").hide().end().append('<div id="WayfindingStatus" style="">'+i.loadMessage+"</div>"),!(Y.length>0))throw t(a).text(i.errorMessage),new p(JSON.stringify(Y));for(o=0;o<Y.length;o++)for(n=o;n<Y.length;n++)o!==n&&Y[o].id===Y[n].id&&(r=!0);if(r===!0)throw t(a).text(i.errorMessage),new l(JSON.stringify(Y));for(o=0;o<Y.length;o++)Y[o].id===z&&(s=!0);if(s===!1)throw t(a).text(i.errorMessage),new h(z)}function c(e,o,n){var a,r,s,p,l=i.locationIndicator.height;return a=document.createElementNS("http://www.w3.org/2000/svg","g"),t(a).attr("class",n),r=document.createElementNS("http://www.w3.org/2000/svg","path"),s=document.createElementNS("http://www.w3.org/2000/svg","circle"),p="M0.075,0",p+="c-2.079-10.207-5.745-18.703-10.186-26.576c-3.295-5.84-7.111-11.23-10.642-16.894c-1.179-1.891-2.196-3.888-3.327-5.85",p+="c-2.266-3.924-4.102-8.472-3.984-14.372c0.113-5.766,1.781-10.391,4.186-14.172c3.954-6.219,10.578-11.317,19.465-12.657",p+="c7.268-1.095,14.08,0.756,18.911,3.58c3.948,2.31,7.005,5.394,9.329,9.027c2.426,3.793,4.096,8.274,4.236,14.12",p+="c0.072,2.995-0.418,5.769-1.109,8.069c-0.699,2.328-1.823,4.274-2.824,6.353c-1.953,4.06-4.4,7.777-6.857,11.498",p+="C9.954,-26.789,3.083,-15.486,0.075,0z",r.setAttribute("d",p),r.setAttribute("fill","#E81E25"),r.setAttribute("stroke","#000000"),r.setAttribute("stroke-width","3.7"),r.setAttribute("stroke-miterlimit","10"),s.setAttribute("cx","0"),s.setAttribute("cy","-63.757"),s.setAttribute("r","9.834"),a.appendChild(r),a.appendChild(s),a.setAttribute("transform","translate("+e+" "+(o-10*(l/125))+") scale("+l/125+")"),a}function d(o,n,i){var a,r,s,p,l,h,f,c,d;e.p[o]=[],t("#Paths line",i).each(function(){a={},a.floor=n.id,a.r=1/0,a.p=-1,a.x=t(this).attr("x1"),a.y=t(this).attr("y1"),a.d=[],a.m=t(this).attr("x2"),a.n=t(this).attr("y2"),a.e=[],a.l=Math.sqrt(Math.pow(a.x-a.m,2)+Math.pow(a.y-a.n,2)),a.c=[],a.q=[],e.p[o].push(a)}),t("#Doors line",i).each(function(){s=t(this).attr("x1"),p=t(this).attr("y1"),l=t(this).attr("x2"),h=t(this).attr("y2"),r=t(this).attr("id"),t.each(e.p[o],function(t,e){n.id===e.floor&&(e.x===s&&e.y===p||e.x===l&&e.y===h)?e.d.push(r):n.id===e.floor&&(e.m===s&&e.n===p||e.m===l&&e.n===h)&&e.e.push(r)})}),t("#Portals line",i).each(function(){c={},d=t(this).attr("id"),d&&d.indexOf("_")>-1&&(d=d.slice(0,d.indexOf("_"))),c.id=d,c.type=d.split(".")[0],c.floor=n.id,c.mate=d.split(".").slice(0,2).join(".")+"."+n.id,c.mapNum=o,c.matched=!1,s=t(this).attr("x1"),p=t(this).attr("y1"),l=t(this).attr("x2"),h=t(this).attr("y2"),f=t.grep(e.p[o],function(t){return s===t.x&&p===t.y||s===t.m&&p===t.n}),0!==f.length?(c.x=s,c.y=p):(c.x=l,c.y=h),c.l=Math.sqrt(Math.pow(s-l,2)+Math.pow(p-h,2)),I.push(c)})}function g(){var t,o,n,i,a,r,s,p,l,h;for(t=0;t<I.length;t++)if(n=I[t],n.matched===!1)for(o=t;o<I.length;o++)I[o].id===n.mate&&I[o].mate===n.id&&(i=I[o],a={},n.matched=!0,i.matched=!0,a.t=n.type,a.a="Elev"===a.t||"Door"===a.t?!0:!1,a.f=n.floor,a.g=n.mapNum,a.x=n.x,a.y=n.y,a.c=[],a.j=i.floor,a.k=i.mapNum,a.m=i.x,a.n=i.y,a.d=[],a.l=n.l+i.l,a.r=1/0,a.p=-1,e.q.push(a));for(r=0;r<Y.length;r++)for(s=0;s<e.p[r].length-1;s++)for(p=s+1;p<e.p[r].length;p++)(e.p[r][p].x===e.p[r][s].x&&e.p[r][p].y===e.p[r][s].y||e.p[r][p].m===e.p[r][s].x&&e.p[r][p].n===e.p[r][s].y||e.p[r][p].x===e.p[r][s].m&&e.p[r][p].y===e.p[r][s].n||e.p[r][p].m===e.p[r][s].m&&e.p[r][p].n===e.p[r][s].n)&&(e.p[r][s].c.push(p),e.p[r][p].c.push(s));for(l=0;l<e.q.length;l++)for(r=0;r<Y.length;r++)for(h=0;h<e.p[r].length;h++)e.q[l].f===e.p[r][h].floor&&(e.q[l].x===e.p[r][h].x&&e.q[l].y===e.p[r][h].y||e.q[l].x===e.p[r][h].m&&e.q[l].y===e.p[r][h].n)?(e.q[l].c.push(h),e.p[r][h].q.push(l)):e.q[l].j===e.p[r][h].floor&&(e.q[l].m===e.p[r][h].x&&e.q[l].n===e.p[r][h].y||e.q[l].m===e.p[r][h].m&&e.q[l].n===e.p[r][h].n)&&(e.q[l].d.push(h),e.p[r][h].q.push(l));I=[]}function u(t){var o,n,i,a,r={paths:[],floor:null};for(o=0;o<Y.length;o++)for(n=0;n<e.p[o].length;n++){for(i=0;i<e.p[o][n].d.length;i++)e.p[o][n].d[i]===t&&(r.paths.push(n),r.floor=e.p[o][n].floor);for(a=0;a<e.p[o][n].e.length;a++)e.p[o][n].e[a]===t&&(r.paths.push(n),r.floor=e.p[o][n].floor)}return r}function m(o,n,a,r){t.each(e.p[n][a].c,function(t,i){r+e.p[n][i].l<e.p[n][i].r&&(e.p[n][i].r=r+e.p[n][i].l,e.p[n][i].p=a,e.p[n][i].o=o,m("pa",n,i,e.p[n][i].r))}),e.p[n][a].q.length>0&&t.each(e.p[n][a].q,function(s,p){r+e.q[p].l<e.q[p].r&&(i.accessibleRoute===!1||i.accessibleRoute===!0&&e.q[p].a)&&(e.q[p].r=r+e.q[p].l,e.q[p].p=a,e.q[p].q=n,e.q[p].o=o,-1!==t.inArray(a,e.q[p].c)?t.each(e.q[p].d,function(t,o){r+e.q[p].l+e.p[e.q[p].k][o].l<e.p[e.q[p].k][o].r&&(e.p[e.q[p].k][o].r=e.q[p].r+e.p[e.q[p].k][o].l,e.p[e.q[p].k][o].p=p,e.p[e.q[p].k][o].o="po",m("pa",e.q[p].k,o,e.p[e.q[p].k][o].r))}):t.each(e.q[p].c,function(t,o){r+e.q[p].l+e.p[e.q[p].g][o].l<e.p[e.q[p].g][o].r&&(e.p[e.q[p].g][o].r=e.q[p].r+e.p[e.q[p].g][o].l,e.p[e.q[p].g][o].p=p,e.p[e.q[p].g][o].o="po",m("pa",e.q[p].g,o,e.p[e.q[p].g][o].r))}))})}function y(){var o,n,i;for(o=u(X),n=0;n<Y.length;n++)if(Y[n].id===o.floor){i=n;break}t.each(o.paths,function(t,o){e.p[i][o].r=e.p[i][o].l,e.p[i][o].p="door",m("pa",i,o,e.p[i][o].l)})}function v(t,o,n){var i;if("door"!==n)switch(i={},i.type=t,i.floor=o,i.segment=n,E.push(i),t){case"pa":v(e.p[o][n].o,o,e.p[o][n].p);break;case"po":v(e.q[n].o,e.q[n].q,e.q[n].p)}}function x(){var t,o,n,a,r,s;for(t=u(i.endpoint),o=0;o<Y.length;o++)if(Y[o].id===t.floor){n=o;break}for(r=1/0,a=-1,s=0;s<t.paths.length;s++)e.p[n][t.paths[s]].r<r&&(r=e.p[n][t.paths[s]].r,a=t.paths[s]);return-1!==a&&(E=[],v("pa",n,a),E.reverse()),E}function w(){return e={p:[],q:[]},I=[],t.each(Y,function(t,e){d(t,e,e.el)}),g(),y(),e}function q(o){if(i.dataStoreCache){if("object"==typeof i.dataStoreCache)e=i.dataStoreCache,"function"==typeof o&&o();else if("string"==typeof i.dataStoreCache){var n=i.dataStoreCache+X+(i.accessibleRoute?".acc":"")+".json";t.getJSON(n,function(t){e=t,"function"==typeof o&&o()}).fail(function(){e=w(),"function"==typeof o&&o()})}}else e=w(),"function"==typeof o&&o()}function b(e,o){var n,a,s,p,l;if(t("g.startPin",o).remove(),i.startpoint=e,X="function"==typeof i.startpoint?i.startpoint():i.startpoint,i.showLocation){n=t("#Doors #"+r(X),o);var h=o.children().has(t("#"+r(X)));if(a=t("svg",h).children().last(),!n.length)return;s=(Number(n.attr("x1"))+Number(n.attr("x2")))/2,p=(Number(n.attr("y1"))+Number(n.attr("y2")))/2,l=c(s,p,"startPin"),a.after(l)}}function k(e,o){var n,a,s,p,l;if(t("g.destinationPin",o).remove(),i.showLocation){if(n=t("#Doors #"+r(e),o),a=t("svg").has('#Rooms a[id="'+r(e)+'"]'),!n.length)return;s=(Number(n.attr("x1"))+Number(n.attr("x2")))/2,p=(Number(n.attr("y1"))+Number(n.attr("y2")))/2,l=c(s,p,"destinationPin"),a.append(l)}}function M(e){var n=e.data("wayfinding:options");O=e.data("wayfinding:drawing"),i=t.extend(!0,{},o,i),i=void 0!==n?n:t.extend(!0,{},o,i),i=t.metadata?t.extend(!0,{},i,e.metadata()):i,Y=i.maps,z="function"==typeof i.defaultMap?i.defaultMap():i.defaultMap,X="function"==typeof i.startpoint?i.startpoint():i.startpoint}function L(t){t.data("wayfinding:options",i),t.data("wayfinding:drawing",O),t.data("wayfinding:data",e)}function A(e){var o=t(e).find("svg"),n=parseInt(t(o).attr("height").replace("px","").split(".")[0],10),i=parseInt(t(o).attr("width").replace("px","").split(".")[0],10);n=2*Math.ceil(n/2),i=2*Math.ceil(i/2),t(e).css("padding-bottom",100*(n/i)+"%"),o.attr("height","100%").attr("width","100%").attr("preserveAspectRatio","xMinYMin meet"),t("#Rooms a, #Doors line",e).each(function(){if(t(this).prop("id")&&t(this).prop("id").indexOf("_")>0){var e=t(this).prop("id");t(this).prop("id",e.slice(0,e.indexOf("_")))}})}function S(t){t.panzoom({minScale:1,contain:"invert",cursor:"pointer"}),t.find("a").on("mousedown touchstart",function(t){t.stopImmediatePropagation()})}function N(e,o){t(o).hide(),t("#Paths line",o).attr("stroke-opacity",0),t("#Doors line",o).attr("stroke-opacity",0),t("#Portals line",o).attr("stroke-opacity",0);var n=t("#Paths",o).parent();n.is("g")&&n.attr("opacity",0).attr("display","inline"),t("#Rooms a",o).click(function(o){t(e).trigger("wayfinding:roomClicked",[{roomId:t(this).attr("id")}]),t(e).wayfinding("routeTo",t(this).prop("id")),o.preventDefault()}),t(o).find("*").css("pointer-events","none"),t("#Rooms a",o).find("*").css("pointer-events","auto"),t(e).append(o),i.pinchToZoom&&S(t(o))}function P(e,o){var n=t(o).height();t(o).height(n),t("div",o).hide(),t("#"+e,o).show(0,function(){t(o).trigger("wayfinding:floorChanged",{mapId:e})});var a,r,s,p;if(O){for(s=-1,a=0;a<Y.length;a++)if(Y[a]===e){s=a;break}for(r=-1,a=0;a<O.length;a++)if(O[a].floor===s){r=a;break}-1!==r&&(p=O[r].routeLength,t(O[r].path,o).attr("stroke-dasharray",[p,p]),t(O[r].path,o).attr("stroke-dashoffset",p),t(O[r].path,o).attr("pathLength",p),t(O[r].path,o).attr("stroke-dashoffset",p),t(O[r].path,o).animate({svgStrokeDashOffset:0},p*i.path.speed))}}function R(e){t("path[class^=directionPath]",e).css({stroke:"none"})}function T(e,o,n,i,a,r){n=parseFloat(n),i=parseFloat(i),a=parseFloat(a),r=parseFloat(r);var s=o.getAttribute("viewBox"),p=parseFloat(s.split(/\s+|,/)[0]),l=parseFloat(s.split(/\s+|,/)[1]),h=parseFloat(s.split(/\s+|,/)[2]),f=parseFloat(s.split(/\s+|,/)[3]),c=t(e).width(),d=t(e).height(),g=Math.min(h/a,f/r);t(e).panzoom("zoom",parseFloat(g));var u=c/h,m=d/f,y=p+h/2,v=l+f/2,x=(y-(n+a/2))*u,w=(v-(i+r/2))*m;t(e).panzoom("pan",x*g,w*g)}function W(e){function o(e,o,n,a,p){setTimeout(function(){var p={};p.X=s(o.X,n.X,e,a),p.Y=s(o.Y,n.Y,e,a),p.W=s(o.W,n.W,e,a),p.H=s(o.H,n.H,e,a),i.pinchToZoom?T(t(r).parent()[0],r,p.X,p.Y,p.W,p.H):r.setAttribute("viewBox",p.X+" "+p.Y+" "+p.W+" "+p.H)},e*(p/a))}function n(o,n,a,p,l){setTimeout(function(){var l={};l.X=s(a.X,n.X,o,p),l.Y=s(a.Y,n.Y,o,p),l.W=s(a.W,n.W,o,p),l.H=s(a.H,n.H,o,p),i.pinchToZoom?T(t(r).parent()[0],r,l.X,l.Y,l.W,l.H):r.setAttribute("viewBox",l.X+" "+l.Y+" "+l.W+" "+l.H),o===p&&e===O.length&&t(H).trigger("wayfinding:animationComplete")},o*(l/p))}var a,r,p,l,h,f,c,d=i.zoomPadding,g=35,u=650,m={},y={};if(i.repeat&&e>=O.length)setTimeout(function(){W(0)},5e3);else if(e>=O.length)return;var v=O[e][0].floor;if(r=t("#"+Y[v].id+" svg")[0],l=O[e].routeLength,f=l*i.path.speed,P(Y[O[e][0].floor].id,H),a=t("#"+Y[O[e][0].floor].id+" .directionPath"+e)[0],a.style.stroke=i.path.color,a.style.strokeWidth=i.path.width,a.style.transition=a.style.WebkitTransition="none",a.style.strokeDasharray=l+" "+l,a.style.strokeDashoffset=l,p=a.getBBox(),a.style.transition=a.style.WebkitTransition="stroke-dashoffset "+f+"ms linear",a.style.strokeDashoffset="0",i.zoomToRoute===!1)e===O.length-1&&t(a).one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(){t(H).trigger("wayfinding:animationComplete")});else for(h=r.getAttribute("viewBox"),m.X=parseFloat(h.split(/\s+|,/)[0]),m.Y=parseFloat(h.split(/\s+|,/)[1]),m.W=parseFloat(h.split(/\s+|,/)[2]),m.H=parseFloat(h.split(/\s+|,/)[3]),y.X=p.x-d>0?p.x-d:0,y.Y=p.y-d>0?p.y-d:0,y.H=p.height+2*d,y.W=p.width+2*d,c=0;g>=c;c++)o(c,m,y,g,u);setTimeout(function(){if(W(++e),i.zoomToRoute)for(c=1===O.length||O.length>1&&e===O.length?0:g;g>=c;c++)n(c,m,y,g,u)},f+i.floorChangeAnimationDelay)}function C(o,n){var a,r,s,p,l,h,f,c,d,g,u,m,y,v,w,q,b,M,L,A,S,N,P,R;if(i.endpoint=o,t("path[class^=directionPath]",H).remove(),t("#Rooms *.wayfindingRoom",H).removeAttr("class"),E=[],X!==o&&(t('#Rooms a[id="'+o+'"] g',H).attr("class","wayfindingRoom"),k(i.endpoint,n),E=x(),-1!==l)){for(h=0,a=0;a<E.length;a++)"po"===E[a].type&&h++;if(O=new Array(h),O[0]=[],r={},0===E.length)return void console.warn("Attempting to route with no solution. This should never happen. SVG likely has errors. Destination is: "+o);for(e.p[E[0].floor][E[0].segment].d[0]===X?(r={},r.floor=E[0].floor,r.type="M",r.x=e.p[E[0].floor][E[0].segment].x,r.y=e.p[E[0].floor][E[0].segment].y,r.length=0,O[0].push(r),r={},r.type="L",r.floor=E[0].floor,r.x=e.p[E[0].floor][E[0].segment].m,r.y=e.p[E[0].floor][E[0].segment].n,r.length=e.p[E[0].floor][E[0].segment].l,O[0].push(r),O[0].routeLength=r.length):e.p[E[0].floor][E[0].segment].e[0]===X&&(r={},r.type="M",r.floor=E[0].floor,r.x=e.p[E[0].floor][E[0].segment].m,r.y=e.p[E[0].floor][E[0].segment].n,r.length=0,O[0].push(r),r={},r.type="L",r.floor=E[0].floor,r.x=e.p[E[0].floor][E[0].segment].x,r.y=e.p[E[0].floor][E[0].segment].y,r.length=e.p[E[0].floor][E[0].segment].l,O[0].push(r),O[0].routeLength=r.length),f=1,a=0;h+1>a;a++)for(s=f;s<E.length;s++)"pa"===E[s].type&&(c=e.p[E[s].floor][E[s].segment].x,d=e.p[E[s].floor][E[s].segment].y,g=e.p[E[s].floor][E[s].segment].m,u=e.p[E[s].floor][E[s].segment].n,r={},r.floor=E[s].floor,O[a].slice(-1)[0].x===c&&O[a].slice(-1)[0].y===d?(r.x=g,r.y=u):(r.x=c,r.y=d),r.length=e.p[E[s].floor][E[s].segment].l,r.type="L",O[a].push(r),O[a].routeLength+=r.length),"po"===E[s].type&&(O[a+1]=[],O[a+1].routeLength=0,R="",e.q[E[s].segment].g===e.q[E[s].segment].k?R=e.q[E[s].segment].x===r.x&&e.q[E[s].segment].y===r.y?"B":"A":e.q[E[s].segment].g===E[s].floor?R="A":e.q[E[s].segment].k===E[s].floor&&(R="B"),"A"===R?(r={},r.floor=E[s].floor,r.type="M",r.x=e.q[E[s].segment].x,r.y=e.q[E[s].segment].y,r.length=0,O[a+1].push(r),O[a+1].routeLength=r.length):"B"===R&&(r={},r.floor=E[s].floor,r.type="M",r.x=e.q[E[s].segment].m,r.y=e.q[E[s].segment].n,r.length=0,O[a+1].push(r),O[a+1].routeLength=r.length),f=s,f++,s=E.length);if(i.path.radius>0)for(p=0;p<O.length;p++){for(a=1;a<O[p].length-1;a++)"L"===O[p][a].type&&"L"===O[p][a].type&&(m=O[p][a-1].x-O[p][a].x,y=O[p][a-1].y-O[p][a].y,v=O[p][a].x-O[p][a+1].x,w=O[p][a].y-O[p][a+1].y,(0===y&&0===w||0===m&&0===v||m/y===v/w&&(0!==m||0!==y||0!==v||0!==w))&&(O[p][a+1].length=O[p][a].length+O[p][a+1].length,O[p].splice(a,1),a=1));for(a=1;a<O[p].length-1;a++)"L"===O[p][a].type&&"L"===O[p][a].type&&O[p][a].length>i.path.radius&&O[p][a+1].length>i.path.radius&&(q=O[p][a].x,b=O[p][a].y,M=O[p][a-1].x,L=O[p][a-1].y,O[p][a].x=Number(M)+(q-M)*((O[p][a].length-i.path.radius)/O[p][a].length),O[p][a].y=Number(L)+(b-L)*((O[p][a].length-i.path.radius)/O[p][a].length),O[p][a].length=O[p][a].length-i.path.radius,A={},A.cx=q,A.cy=b,S=O[p][a+1].x,N=O[p][a+1].y,A.x=Number(q)+(S-q)*(i.path.radius/O[p][a+1].length),A.y=Number(b)+(N-b)*(i.path.radius/O[p][a+1].length),O[p][a+1].length=O[p][a+1].length-i.path.radius,A.type="Q",A.floor=O[p][a].floor,O[p].splice(a+1,0,A))}t.each(O,function(e,o){var n,i="";t.each(o,function(t,e){switch(e.type){case"M":i="M"+e.x+","+e.y;break;case"L":i+="L"+e.x+","+e.y;break;case"Q":i+="Q"+e.cx+","+e.cy+" "+e.x+","+e.y}}),n=document.createElementNS("http://www.w3.org/2000/svg","path"),n.setAttribute("d",i),n.style.fill="none",n.classList?n.classList.add("directionPath"+e):n.setAttribute("class","directionPath"+e);var a=t("#"+Y[o[0].floor].id+" svg"),r=t(".startPin",a),s=t(".destinationPin",a);r.length?r.before(n):s.length?s.before(n):a.append(n),P=t("#"+Y[o[0].floor].id+" svg .directionPath"+e),O[e].path=P}),W(0)}}function D(e){var o,n;for(t("#WayfindingStatus").remove(),o=0,n=0;n<Y.length;n++)z===Y[n].id&&(o=n);t("#"+Y[o].id,e).show(),t(e).trigger("wayfinding:mapsVisible"),"function"==typeof i.endpoint?C(i.endpoint(),e):"string"==typeof i.endpoint&&C(i.endpoint,e),t.event.trigger("wayfinding:ready")}function F(e,o){var n=0;t('div:not("#WayfindingStatus")',e).remove(),t.each(Y,function(i,a){var r=t('<div id="'+a.id+'"></div>');r.load(a.path,function(t,s){"error"===s?(r.html('<p class="text-center text-danger">Map '+i+" Was not found at "+a.path+"<br />Please upload it in the administration section</p>"),Y[i].el=r):(Y[i].svgHandle=t,Y[i].el=r,A(Y[i].el),N(e,r),n+=1),n===Y.length&&q(function(){b(X,e),L(e),D(e),"function"==typeof o&&o()})})})}var H,Y,z,X,E,B,O,j=i,I=[];return n&&"object"==typeof n&&("function"==typeof i&&(a=i),i=n,j=n,n="initialize"),this.each(function(){if(H=t(this),M(H),n&&"string"==typeof n)switch(n){case"initialize":j&&j.maps?(f(H),F(H,a)):j&&void 0!==j.showLocation&&(i.showLocation=j.showLocation,b(i.startpoint,H));break;case"routeTo":C(j,H);break;case"animatePath":R(H),W(0);break;case"startpoint":void 0===j?B=X:(b(j,H),q(a));break;case"currentMap":void 0===j?B=t("div:visible",H).prop("id"):P(j,H);break;case"accessibleRoute":void 0===j?B=i.accessibleRoute:(i.accessibleRoute=j,q(a));break;case"path":void 0===j?B=i.path:i.path=t.extend(!0,{},i.path,j);break;case"getDataStore":B=JSON.stringify(e);break;case"destroy":t(H).remove()}L(H)}),void 0!==B?B:this}}(jQuery);